#!/bin/bash

echo ‘post-receive: Triggered..’
echo 'pwd' "$(pwd)"
cd ~
cd /srv/users/sfr-org/apps/summerfoodrocks-org/public
echo ‘post-receive: git check out…’
git --git-dir=/srv/users/sfr-org/sfr.git --work-tree=/srv/users/sfr-org/apps/summerfoodrocks-org/public checkout master -f
echo ‘post-receive: npm install…’
npm install \
&& echo ‘post-receive: building…’ \
&& npm run build \
echo ‘post-receive: → done.’ \
&& (pm2 delete ‘sfrserver.js’ || true) \
&& NODE_ENV=production pm2 start npm --name ‘sfrserver.js’ -- start \
&& echo ‘post-receive: app started successfully with pm2